{"version":3,"sources":["../../src/HTML5BackendImpl.ts"],"sourcesContent":["import type {\n\tBackend,\n\tDragDropManager,\n\tDragDropActions,\n\tDragDropMonitor,\n\tHandlerRegistry,\n\tIdentifier,\n\tXYCoord,\n\tUnsubscribe,\n} from 'dnd-core'\nimport { EnterLeaveCounter } from './EnterLeaveCounter.js'\nimport {\n\tgetNodeClientOffset,\n\tgetEventClientOffset,\n\tgetDragPreviewOffset,\n} from './OffsetUtils.js'\nimport {\n\tcreateNativeDragSource,\n\tmatchNativeItemType,\n} from './NativeDragSources/index.js'\nimport * as NativeTypes from './NativeTypes.js'\nimport type { NativeDragSource } from './NativeDragSources/NativeDragSource.js'\nimport { OptionsReader } from './OptionsReader.js'\nimport type { HTML5BackendContext, HTML5BackendOptions } from './types.js'\n\ntype RootNode = Node & { __isReactDndBackendSetUp: boolean | undefined }\n\nexport class HTML5BackendImpl implements Backend {\n\tprivate options: OptionsReader\n\n\t// React-Dnd Components\n\tprivate actions: DragDropActions\n\tprivate monitor: DragDropMonitor\n\tprivate registry: HandlerRegistry\n\n\t// Internal State\n\tprivate enterLeaveCounter: EnterLeaveCounter\n\n\tprivate sourcePreviewNodes: Map<string, Element> = new Map()\n\tprivate sourcePreviewNodeOptions: Map<string, any> = new Map()\n\tprivate sourceNodes: Map<string, Element> = new Map()\n\tprivate sourceNodeOptions: Map<string, any> = new Map()\n\n\tprivate dragStartSourceIds: string[] | null = null\n\tprivate dropTargetIds: string[] = []\n\tprivate dragEnterTargetIds: string[] = []\n\tprivate currentNativeSource: NativeDragSource | null = null\n\tprivate currentNativeHandle: Identifier | null = null\n\tprivate currentDragSourceNode: Element | null = null\n\tprivate altKeyPressed = false\n\tprivate mouseMoveTimeoutTimer: number | null = null\n\tprivate asyncEndDragFrameId: number | null = null\n\tprivate dragOverTargetIds: string[] | null = null\n\n\tprivate lastClientOffset: XYCoord | null = null\n\tprivate hoverRafId: number | null = null\n\n\tpublic constructor(\n\t\tmanager: DragDropManager,\n\t\tglobalContext?: HTML5BackendContext,\n\t\toptions?: HTML5BackendOptions,\n\t) {\n\t\tthis.options = new OptionsReader(globalContext, options)\n\t\tthis.actions = manager.getActions()\n\t\tthis.monitor = manager.getMonitor()\n\t\tthis.registry = manager.getRegistry()\n\t\tthis.enterLeaveCounter = new EnterLeaveCounter(this.isNodeInDocument)\n\t}\n\n\t/**\n\t * Generate profiling statistics for the HTML5Backend.\n\t */\n\tpublic profile(): Record<string, number> {\n\t\treturn {\n\t\t\tsourcePreviewNodes: this.sourcePreviewNodes.size,\n\t\t\tsourcePreviewNodeOptions: this.sourcePreviewNodeOptions.size,\n\t\t\tsourceNodeOptions: this.sourceNodeOptions.size,\n\t\t\tsourceNodes: this.sourceNodes.size,\n\t\t\tdragStartSourceIds: this.dragStartSourceIds?.length || 0,\n\t\t\tdropTargetIds: this.dropTargetIds.length,\n\t\t\tdragEnterTargetIds: this.dragEnterTargetIds.length,\n\t\t\tdragOverTargetIds: this.dragOverTargetIds?.length || 0,\n\t\t}\n\t}\n\n\t// public for test\n\tpublic get window(): Window | undefined {\n\t\treturn this.options.window\n\t}\n\tpublic get document(): Document | undefined {\n\t\treturn this.options.document\n\t}\n\t/**\n\t * Get the root element to use for event subscriptions\n\t */\n\tprivate get rootElement(): Node | undefined {\n\t\treturn this.options.rootElement as Node\n\t}\n\n\tpublic setup(): void {\n\t\tconst root = this.rootElement as RootNode | undefined\n\t\tif (root === undefined) {\n\t\t\treturn\n\t\t}\n\n\t\tif (root.__isReactDndBackendSetUp) {\n\t\t\tthrow new Error('Cannot have two HTML5 backends at the same time.')\n\t\t}\n\t\troot.__isReactDndBackendSetUp = true\n\t\tthis.addEventListeners(root)\n\t}\n\n\tpublic teardown(): void {\n\t\tconst root = this.rootElement as RootNode\n\t\tif (root === undefined) {\n\t\t\treturn\n\t\t}\n\n\t\troot.__isReactDndBackendSetUp = false\n\t\tthis.removeEventListeners(this.rootElement as Element)\n\t\tthis.clearCurrentDragSourceNode()\n\t\tif (this.asyncEndDragFrameId) {\n\t\t\tthis.window?.cancelAnimationFrame(this.asyncEndDragFrameId)\n\t\t}\n\t}\n\n\tpublic connectDragPreview(\n\t\tsourceId: string,\n\t\tnode: Element,\n\t\toptions: any,\n\t): Unsubscribe {\n\t\tthis.sourcePreviewNodeOptions.set(sourceId, options)\n\t\tthis.sourcePreviewNodes.set(sourceId, node)\n\n\t\treturn (): void => {\n\t\t\tthis.sourcePreviewNodes.delete(sourceId)\n\t\t\tthis.sourcePreviewNodeOptions.delete(sourceId)\n\t\t}\n\t}\n\n\tpublic connectDragSource(\n\t\tsourceId: string,\n\t\tnode: Element,\n\t\toptions: any,\n\t): Unsubscribe {\n\t\tthis.sourceNodes.set(sourceId, node)\n\t\tthis.sourceNodeOptions.set(sourceId, options)\n\n\t\tconst handleDragStart = (e: any) => this.handleDragStart(e, sourceId)\n\t\tconst handleSelectStart = (e: any) => this.handleSelectStart(e)\n\n\t\tnode.setAttribute('draggable', '' + this.monitor.canDragSource(sourceId))\n\t\tnode.addEventListener('dragstart', handleDragStart)\n\t\tnode.addEventListener('selectstart', handleSelectStart)\n\n\t\treturn (): void => {\n\t\t\tthis.sourceNodes.delete(sourceId)\n\t\t\tthis.sourceNodeOptions.delete(sourceId)\n\n\t\t\tnode.removeEventListener('dragstart', handleDragStart)\n\t\t\tnode.removeEventListener('selectstart', handleSelectStart)\n\t\t\tnode.setAttribute('draggable', 'false')\n\t\t}\n\t}\n\n\tpublic connectDropTarget(targetId: string, node: HTMLElement): Unsubscribe {\n\t\tconst handleDragEnter = (e: DragEvent) => this.handleDragEnter(e, targetId)\n\t\tconst handleDragOver = (e: DragEvent) => this.handleDragOver(e, targetId)\n\t\tconst handleDrop = (e: DragEvent) => this.handleDrop(e, targetId)\n\n\t\tnode.addEventListener('dragenter', handleDragEnter)\n\t\tnode.addEventListener('dragover', handleDragOver)\n\t\tnode.addEventListener('drop', handleDrop)\n\n\t\treturn (): void => {\n\t\t\tnode.removeEventListener('dragenter', handleDragEnter)\n\t\t\tnode.removeEventListener('dragover', handleDragOver)\n\t\t\tnode.removeEventListener('drop', handleDrop)\n\t\t}\n\t}\n\n\tprivate addEventListeners(target: Node) {\n\t\t// SSR Fix (https://github.com/react-dnd/react-dnd/pull/813\n\t\tif (!target.addEventListener) {\n\t\t\treturn\n\t\t}\n\t\ttarget.addEventListener(\n\t\t\t'dragstart',\n\t\t\tthis.handleTopDragStart as EventListener,\n\t\t)\n\t\ttarget.addEventListener('dragstart', this.handleTopDragStartCapture, true)\n\t\ttarget.addEventListener('dragend', this.handleTopDragEndCapture, true)\n\t\ttarget.addEventListener(\n\t\t\t'dragenter',\n\t\t\tthis.handleTopDragEnter as EventListener,\n\t\t)\n\t\ttarget.addEventListener(\n\t\t\t'dragenter',\n\t\t\tthis.handleTopDragEnterCapture as EventListener,\n\t\t\ttrue,\n\t\t)\n\t\ttarget.addEventListener(\n\t\t\t'dragleave',\n\t\t\tthis.handleTopDragLeaveCapture as EventListener,\n\t\t\ttrue,\n\t\t)\n\t\ttarget.addEventListener('dragover', this.handleTopDragOver as EventListener)\n\t\ttarget.addEventListener(\n\t\t\t'dragover',\n\t\t\tthis.handleTopDragOverCapture as EventListener,\n\t\t\ttrue,\n\t\t)\n\t\ttarget.addEventListener('drop', this.handleTopDrop as EventListener)\n\t\ttarget.addEventListener(\n\t\t\t'drop',\n\t\t\tthis.handleTopDropCapture as EventListener,\n\t\t\ttrue,\n\t\t)\n\t}\n\n\tprivate removeEventListeners(target: Node) {\n\t\t// SSR Fix (https://github.com/react-dnd/react-dnd/pull/813\n\t\tif (!target.removeEventListener) {\n\t\t\treturn\n\t\t}\n\t\ttarget.removeEventListener('dragstart', this.handleTopDragStart as any)\n\t\ttarget.removeEventListener(\n\t\t\t'dragstart',\n\t\t\tthis.handleTopDragStartCapture,\n\t\t\ttrue,\n\t\t)\n\t\ttarget.removeEventListener('dragend', this.handleTopDragEndCapture, true)\n\t\ttarget.removeEventListener(\n\t\t\t'dragenter',\n\t\t\tthis.handleTopDragEnter as EventListener,\n\t\t)\n\t\ttarget.removeEventListener(\n\t\t\t'dragenter',\n\t\t\tthis.handleTopDragEnterCapture as EventListener,\n\t\t\ttrue,\n\t\t)\n\t\ttarget.removeEventListener(\n\t\t\t'dragleave',\n\t\t\tthis.handleTopDragLeaveCapture as EventListener,\n\t\t\ttrue,\n\t\t)\n\t\ttarget.removeEventListener(\n\t\t\t'dragover',\n\t\t\tthis.handleTopDragOver as EventListener,\n\t\t)\n\t\ttarget.removeEventListener(\n\t\t\t'dragover',\n\t\t\tthis.handleTopDragOverCapture as EventListener,\n\t\t\ttrue,\n\t\t)\n\t\ttarget.removeEventListener('drop', this.handleTopDrop as EventListener)\n\t\ttarget.removeEventListener(\n\t\t\t'drop',\n\t\t\tthis.handleTopDropCapture as EventListener,\n\t\t\ttrue,\n\t\t)\n\t}\n\n\tprivate getCurrentSourceNodeOptions() {\n\t\tconst sourceId = this.monitor.getSourceId() as string\n\t\tconst sourceNodeOptions = this.sourceNodeOptions.get(sourceId)\n\n\t\treturn {\n\t\t\tdropEffect: this.altKeyPressed ? 'copy' : 'move',\n\t\t\t...(sourceNodeOptions || {}),\n\t\t}\n\t}\n\n\tprivate getCurrentDropEffect() {\n\t\tif (this.isDraggingNativeItem()) {\n\t\t\t// It makes more sense to default to 'copy' for native resources\n\t\t\treturn 'copy'\n\t\t}\n\n\t\treturn this.getCurrentSourceNodeOptions().dropEffect\n\t}\n\n\tprivate getCurrentSourcePreviewNodeOptions() {\n\t\tconst sourceId = this.monitor.getSourceId() as string\n\t\tconst sourcePreviewNodeOptions = this.sourcePreviewNodeOptions.get(sourceId)\n\n\t\treturn {\n\t\t\tanchorX: 0.5,\n\t\t\tanchorY: 0.5,\n\t\t\tcaptureDraggingState: false,\n\t\t\t...(sourcePreviewNodeOptions || {}),\n\t\t}\n\t}\n\n\tprivate getSourceClientOffset = (sourceId: string): XYCoord | null => {\n\t\tconst source = this.sourceNodes.get(sourceId)\n\t\treturn (source && getNodeClientOffset(source as HTMLElement)) || null\n\t}\n\n\tprivate isDraggingNativeItem() {\n\t\tconst itemType = this.monitor.getItemType()\n\t\treturn Object.keys(NativeTypes).some(\n\t\t\t(key: string) => (NativeTypes as any)[key] === itemType,\n\t\t)\n\t}\n\n\tprivate beginDragNativeItem(type: string, dataTransfer?: DataTransfer) {\n\t\tthis.clearCurrentDragSourceNode()\n\n\t\tthis.currentNativeSource = createNativeDragSource(type, dataTransfer)\n\t\tthis.currentNativeHandle = this.registry.addSource(\n\t\t\ttype,\n\t\t\tthis.currentNativeSource,\n\t\t)\n\t\tthis.actions.beginDrag([this.currentNativeHandle])\n\t}\n\n\tprivate endDragNativeItem = (): void => {\n\t\tif (!this.isDraggingNativeItem()) {\n\t\t\treturn\n\t\t}\n\n\t\tthis.actions.endDrag()\n\t\tif (this.currentNativeHandle) {\n\t\t\tthis.registry.removeSource(this.currentNativeHandle)\n\t\t}\n\t\tthis.currentNativeHandle = null\n\t\tthis.currentNativeSource = null\n\t}\n\n\tprivate isNodeInDocument = (node: Node | null | undefined): boolean => {\n\t\t// Check the node either in the main document or in the current context\n\t\treturn Boolean(\n\t\t\tnode &&\n\t\t\t\tthis.document &&\n\t\t\t\tthis.document.body &&\n\t\t\t\tthis.document.body.contains(node),\n\t\t)\n\t}\n\n\tprivate endDragIfSourceWasRemovedFromDOM = (): void => {\n\t\tconst node = this.currentDragSourceNode\n\t\tif (node == null || this.isNodeInDocument(node)) {\n\t\t\treturn\n\t\t}\n\n\t\tif (this.clearCurrentDragSourceNode() && this.monitor.isDragging()) {\n\t\t\tthis.actions.endDrag()\n\t\t}\n\t}\n\n\tprivate setCurrentDragSourceNode(node: Element | null) {\n\t\tthis.clearCurrentDragSourceNode()\n\t\tthis.currentDragSourceNode = node\n\n\t\t// A timeout of > 0 is necessary to resolve Firefox issue referenced\n\t\t// See:\n\t\t//   * https://github.com/react-dnd/react-dnd/pull/928\n\t\t//   * https://github.com/react-dnd/react-dnd/issues/869\n\t\tconst MOUSE_MOVE_TIMEOUT = 1000\n\n\t\t// Receiving a mouse event in the middle of a dragging operation\n\t\t// means it has ended and the drag source node disappeared from DOM,\n\t\t// so the browser didn't dispatch the dragend event.\n\t\t//\n\t\t// We need to wait before we start listening for mousemove events.\n\t\t// This is needed because the drag preview needs to be drawn or else it fires an 'mousemove' event\n\t\t// immediately in some browsers.\n\t\t//\n\t\t// See:\n\t\t//   * https://github.com/react-dnd/react-dnd/pull/928\n\t\t//   * https://github.com/react-dnd/react-dnd/issues/869\n\t\t//\n\t\tthis.mouseMoveTimeoutTimer = setTimeout(() => {\n\t\t\treturn this.rootElement?.addEventListener(\n\t\t\t\t'mousemove',\n\t\t\t\tthis.endDragIfSourceWasRemovedFromDOM,\n\t\t\t\ttrue,\n\t\t\t)\n\t\t}, MOUSE_MOVE_TIMEOUT) as any as number\n\t}\n\n\tprivate clearCurrentDragSourceNode() {\n\t\tif (this.currentDragSourceNode) {\n\t\t\tthis.currentDragSourceNode = null\n\n\t\t\tif (this.rootElement) {\n\t\t\t\tthis.window?.clearTimeout(this.mouseMoveTimeoutTimer || undefined)\n\t\t\t\tthis.rootElement.removeEventListener(\n\t\t\t\t\t'mousemove',\n\t\t\t\t\tthis.endDragIfSourceWasRemovedFromDOM,\n\t\t\t\t\ttrue,\n\t\t\t\t)\n\t\t\t}\n\n\t\t\tthis.mouseMoveTimeoutTimer = null\n\t\t\treturn true\n\t\t}\n\n\t\treturn false\n\t}\n\n\tpublic handleTopDragStartCapture = (): void => {\n\t\tthis.clearCurrentDragSourceNode()\n\t\tthis.dragStartSourceIds = []\n\t}\n\n\tpublic handleDragStart(e: DragEvent, sourceId: string): void {\n\t\tif (e.defaultPrevented) {\n\t\t\treturn\n\t\t}\n\n\t\tif (!this.dragStartSourceIds) {\n\t\t\tthis.dragStartSourceIds = []\n\t\t}\n\t\tthis.dragStartSourceIds.unshift(sourceId)\n\t}\n\n\tpublic handleTopDragStart = (e: DragEvent): void => {\n\t\tif (e.defaultPrevented) {\n\t\t\treturn\n\t\t}\n\n\t\tconst { dragStartSourceIds } = this\n\t\tthis.dragStartSourceIds = null\n\n\t\tconst clientOffset = getEventClientOffset(e)\n\n\t\t// Avoid crashing if we missed a drop event or our previous drag died\n\t\tif (this.monitor.isDragging()) {\n\t\t\tthis.actions.endDrag()\n\t\t}\n\n\t\t// Don't publish the source just yet (see why below)\n\t\tthis.actions.beginDrag(dragStartSourceIds || [], {\n\t\t\tpublishSource: false,\n\t\t\tgetSourceClientOffset: this.getSourceClientOffset,\n\t\t\tclientOffset,\n\t\t})\n\n\t\tconst { dataTransfer } = e\n\t\tconst nativeType = matchNativeItemType(dataTransfer)\n\n\t\tif (this.monitor.isDragging()) {\n\t\t\tif (dataTransfer && typeof dataTransfer.setDragImage === 'function') {\n\t\t\t\t// Use custom drag image if user specifies it.\n\t\t\t\t// If child drag source refuses drag but parent agrees,\n\t\t\t\t// use parent's node as drag image. Neither works in IE though.\n\t\t\t\tconst sourceId: string = this.monitor.getSourceId() as string\n\t\t\t\tconst sourceNode = this.sourceNodes.get(sourceId)\n\t\t\t\tconst dragPreview = this.sourcePreviewNodes.get(sourceId) || sourceNode\n\n\t\t\t\tif (dragPreview) {\n\t\t\t\t\tconst { anchorX, anchorY, offsetX, offsetY } =\n\t\t\t\t\t\tthis.getCurrentSourcePreviewNodeOptions()\n\t\t\t\t\tconst anchorPoint = { anchorX, anchorY }\n\t\t\t\t\tconst offsetPoint = { offsetX, offsetY }\n\t\t\t\t\tconst dragPreviewOffset = getDragPreviewOffset(\n\t\t\t\t\t\tsourceNode as HTMLElement,\n\t\t\t\t\t\tdragPreview as HTMLElement,\n\t\t\t\t\t\tclientOffset,\n\t\t\t\t\t\tanchorPoint,\n\t\t\t\t\t\toffsetPoint,\n\t\t\t\t\t)\n\n\t\t\t\t\tdataTransfer.setDragImage(\n\t\t\t\t\t\tdragPreview,\n\t\t\t\t\t\tdragPreviewOffset.x,\n\t\t\t\t\t\tdragPreviewOffset.y,\n\t\t\t\t\t)\n\t\t\t\t}\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\t// Firefox won't drag without setting data\n\t\t\t\tdataTransfer?.setData('application/json', {} as any)\n\t\t\t} catch (err) {\n\t\t\t\t// IE doesn't support MIME types in setData\n\t\t\t}\n\n\t\t\t// Store drag source node so we can check whether\n\t\t\t// it is removed from DOM and trigger endDrag manually.\n\t\t\tthis.setCurrentDragSourceNode(e.target as Element)\n\n\t\t\t// Now we are ready to publish the drag source.. or are we not?\n\t\t\tconst { captureDraggingState } = this.getCurrentSourcePreviewNodeOptions()\n\t\t\tif (!captureDraggingState) {\n\t\t\t\t// Usually we want to publish it in the next tick so that browser\n\t\t\t\t// is able to screenshot the current (not yet dragging) state.\n\t\t\t\t//\n\t\t\t\t// It also neatly avoids a situation where render() returns null\n\t\t\t\t// in the same tick for the source element, and browser freaks out.\n\t\t\t\tsetTimeout(() => this.actions.publishDragSource(), 0)\n\t\t\t} else {\n\t\t\t\t// In some cases the user may want to override this behavior, e.g.\n\t\t\t\t// to work around IE not supporting custom drag previews.\n\t\t\t\t//\n\t\t\t\t// When using a custom drag layer, the only way to prevent\n\t\t\t\t// the default drag preview from drawing in IE is to screenshot\n\t\t\t\t// the dragging state in which the node itself has zero opacity\n\t\t\t\t// and height. In this case, though, returning null from render()\n\t\t\t\t// will abruptly end the dragging, which is not obvious.\n\t\t\t\t//\n\t\t\t\t// This is the reason such behavior is strictly opt-in.\n\t\t\t\tthis.actions.publishDragSource()\n\t\t\t}\n\t\t} else if (nativeType) {\n\t\t\t// A native item (such as URL) dragged from inside the document\n\t\t\tthis.beginDragNativeItem(nativeType)\n\t\t} else if (\n\t\t\tdataTransfer &&\n\t\t\t!dataTransfer.types &&\n\t\t\t((e.target && !(e.target as Element).hasAttribute) ||\n\t\t\t\t!(e.target as Element).hasAttribute('draggable'))\n\t\t) {\n\t\t\t// Looks like a Safari bug: dataTransfer.types is null, but there was no draggable.\n\t\t\t// Just let it drag. It's a native type (URL or text) and will be picked up in\n\t\t\t// dragenter handler.\n\t\t\treturn\n\t\t} else {\n\t\t\t// If by this time no drag source reacted, tell browser not to drag.\n\t\t\te.preventDefault()\n\t\t}\n\t}\n\n\tpublic handleTopDragEndCapture = (): void => {\n\t\tif (this.clearCurrentDragSourceNode() && this.monitor.isDragging()) {\n\t\t\t// Firefox can dispatch this event in an infinite loop\n\t\t\t// if dragend handler does something like showing an alert.\n\t\t\t// Only proceed if we have not handled it already.\n\t\t\tthis.actions.endDrag()\n\t\t}\n\t}\n\n\tpublic handleTopDragEnterCapture = (e: DragEvent): void => {\n\t\tthis.dragEnterTargetIds = []\n\n\t\tif (this.isDraggingNativeItem()) {\n\t\t\tthis.currentNativeSource?.loadDataTransfer(e.dataTransfer)\n\t\t}\n\n\t\tconst isFirstEnter = this.enterLeaveCounter.enter(e.target)\n\t\tif (!isFirstEnter || this.monitor.isDragging()) {\n\t\t\treturn\n\t\t}\n\n\t\tconst { dataTransfer } = e\n\t\tconst nativeType = matchNativeItemType(dataTransfer)\n\n\t\tif (nativeType) {\n\t\t\t// A native item (such as file or URL) dragged from outside the document\n\t\t\tthis.beginDragNativeItem(nativeType, dataTransfer as DataTransfer)\n\t\t}\n\t}\n\n\tpublic handleDragEnter(_e: DragEvent, targetId: string): void {\n\t\tthis.dragEnterTargetIds.unshift(targetId)\n\t}\n\n\tpublic handleTopDragEnter = (e: DragEvent): void => {\n\t\tconst { dragEnterTargetIds } = this\n\t\tthis.dragEnterTargetIds = []\n\n\t\tif (!this.monitor.isDragging()) {\n\t\t\t// This is probably a native item type we don't understand.\n\t\t\treturn\n\t\t}\n\n\t\tthis.altKeyPressed = e.altKey\n\n\t\t// If the target changes position as the result of `dragenter`, `dragover` might still\n\t\t// get dispatched despite target being no longer there. The easy solution is to check\n\t\t// whether there actually is a target before firing `hover`.\n\t\tif (dragEnterTargetIds.length > 0) {\n\t\t\tthis.actions.hover(dragEnterTargetIds, {\n\t\t\t\tclientOffset: getEventClientOffset(e),\n\t\t\t})\n\t\t}\n\n\t\tconst canDrop = dragEnterTargetIds.some((targetId) =>\n\t\t\tthis.monitor.canDropOnTarget(targetId),\n\t\t)\n\n\t\tif (canDrop) {\n\t\t\t// IE requires this to fire dragover events\n\t\t\te.preventDefault()\n\t\t\tif (e.dataTransfer) {\n\t\t\t\te.dataTransfer.dropEffect = this.getCurrentDropEffect()\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic handleTopDragOverCapture = (e: DragEvent): void => {\n\t\tthis.dragOverTargetIds = []\n\n\t\tif (this.isDraggingNativeItem()) {\n\t\t\tthis.currentNativeSource?.loadDataTransfer(e.dataTransfer)\n\t\t}\n\t}\n\n\tpublic handleDragOver(_e: DragEvent, targetId: string): void {\n\t\tif (this.dragOverTargetIds === null) {\n\t\t\tthis.dragOverTargetIds = []\n\t\t}\n\t\tthis.dragOverTargetIds.unshift(targetId)\n\t}\n\n\tpublic handleTopDragOver = (e: DragEvent): void => {\n\t\tconst { dragOverTargetIds } = this\n\t\tthis.dragOverTargetIds = []\n\n\t\tif (!this.monitor.isDragging()) {\n\t\t\t// This is probably a native item type we don't understand.\n\t\t\t// Prevent default \"drop and blow away the whole document\" action.\n\t\t\te.preventDefault()\n\t\t\tif (e.dataTransfer) {\n\t\t\t\te.dataTransfer.dropEffect = 'none'\n\t\t\t}\n\t\t\treturn\n\t\t}\n\n\t\tthis.altKeyPressed = e.altKey\n\t\tthis.lastClientOffset = getEventClientOffset(e)\n\n\t\tif (\n\t\t\tthis.hoverRafId === null &&\n\t\t\ttypeof requestAnimationFrame !== 'undefined'\n\t\t) {\n\t\t\tthis.hoverRafId = requestAnimationFrame(() => {\n\t\t\t\tif (this.monitor.isDragging()) {\n\t\t\t\t\tthis.actions.hover(dragOverTargetIds || [], {\n\t\t\t\t\t\tclientOffset: this.lastClientOffset,\n\t\t\t\t\t})\n\t\t\t\t}\n\n\t\t\t\tthis.hoverRafId = null\n\t\t\t})\n\t\t}\n\n\t\tconst canDrop = (dragOverTargetIds || []).some((targetId) =>\n\t\t\tthis.monitor.canDropOnTarget(targetId),\n\t\t)\n\n\t\tif (canDrop) {\n\t\t\t// Show user-specified drop effect.\n\t\t\te.preventDefault()\n\t\t\tif (e.dataTransfer) {\n\t\t\t\te.dataTransfer.dropEffect = this.getCurrentDropEffect()\n\t\t\t}\n\t\t} else if (this.isDraggingNativeItem()) {\n\t\t\t// Don't show a nice cursor but still prevent default\n\t\t\t// \"drop and blow away the whole document\" action.\n\t\t\te.preventDefault()\n\t\t} else {\n\t\t\te.preventDefault()\n\t\t\tif (e.dataTransfer) {\n\t\t\t\te.dataTransfer.dropEffect = 'none'\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic handleTopDragLeaveCapture = (e: DragEvent): void => {\n\t\tif (this.isDraggingNativeItem()) {\n\t\t\te.preventDefault()\n\t\t}\n\n\t\tconst isLastLeave = this.enterLeaveCounter.leave(e.target)\n\t\tif (!isLastLeave) {\n\t\t\treturn\n\t\t}\n\n\t\tif (this.isDraggingNativeItem()) {\n\t\t\tsetTimeout(() => this.endDragNativeItem(), 0)\n\t\t}\n\t}\n\n\tpublic handleTopDropCapture = (e: DragEvent): void => {\n\t\tthis.dropTargetIds = []\n\n\t\tif (this.isDraggingNativeItem()) {\n\t\t\te.preventDefault()\n\t\t\tthis.currentNativeSource?.loadDataTransfer(e.dataTransfer)\n\t\t} else if (matchNativeItemType(e.dataTransfer)) {\n\t\t\t// Dragging some elements, like <a> and <img> may still behave like a native drag event,\n\t\t\t// even if the current drag event matches a user-defined type.\n\t\t\t// Stop the default behavior when we're not expecting a native item to be dropped.\n\n\t\t\te.preventDefault()\n\t\t}\n\n\t\tthis.enterLeaveCounter.reset()\n\t}\n\n\tpublic handleDrop(_e: DragEvent, targetId: string): void {\n\t\tthis.dropTargetIds.unshift(targetId)\n\t}\n\n\tpublic handleTopDrop = (e: DragEvent): void => {\n\t\tconst { dropTargetIds } = this\n\t\tthis.dropTargetIds = []\n\n\t\tthis.actions.hover(dropTargetIds, {\n\t\t\tclientOffset: getEventClientOffset(e),\n\t\t})\n\t\tthis.actions.drop({ dropEffect: this.getCurrentDropEffect() })\n\n\t\tif (this.isDraggingNativeItem()) {\n\t\t\tthis.endDragNativeItem()\n\t\t} else if (this.monitor.isDragging()) {\n\t\t\tthis.actions.endDrag()\n\t\t}\n\t}\n\n\tpublic handleSelectStart = (e: DragEvent): void => {\n\t\tconst target = e.target as HTMLElement & { dragDrop: () => void }\n\n\t\t// Only IE requires us to explicitly say\n\t\t// we want drag drop operation to start\n\t\tif (typeof target.dragDrop !== 'function') {\n\t\t\treturn\n\t\t}\n\n\t\t// Inputs and textareas should be selectable\n\t\tif (\n\t\t\ttarget.tagName === 'INPUT' ||\n\t\t\ttarget.tagName === 'SELECT' ||\n\t\t\ttarget.tagName === 'TEXTAREA' ||\n\t\t\ttarget.isContentEditable\n\t\t) {\n\t\t\treturn\n\t\t}\n\n\t\t// For other targets, ask IE\n\t\t// to enable drag and drop\n\t\te.preventDefault()\n\t\ttarget.dragDrop()\n\t}\n}\n"],"names":["EnterLeaveCounter","getNodeClientOffset","getEventClientOffset","getDragPreviewOffset","createNativeDragSource","matchNativeItemType","NativeTypes","OptionsReader","HTML5BackendImpl","profile","sourcePreviewNodes","size","sourcePreviewNodeOptions","sourceNodeOptions","sourceNodes","dragStartSourceIds","length","dropTargetIds","dragEnterTargetIds","dragOverTargetIds","window","options","document","rootElement","setup","root","undefined","__isReactDndBackendSetUp","Error","addEventListeners","teardown","removeEventListeners","clearCurrentDragSourceNode","asyncEndDragFrameId","cancelAnimationFrame","connectDragPreview","sourceId","node","set","delete","connectDragSource","handleDragStart","e","handleSelectStart","setAttribute","monitor","canDragSource","addEventListener","removeEventListener","connectDropTarget","targetId","handleDragEnter","handleDragOver","handleDrop","target","handleTopDragStart","handleTopDragStartCapture","handleTopDragEndCapture","handleTopDragEnter","handleTopDragEnterCapture","handleTopDragLeaveCapture","handleTopDragOver","handleTopDragOverCapture","handleTopDrop","handleTopDropCapture","getCurrentSourceNodeOptions","getSourceId","get","dropEffect","altKeyPressed","getCurrentDropEffect","isDraggingNativeItem","getCurrentSourcePreviewNodeOptions","anchorX","anchorY","captureDraggingState","itemType","getItemType","Object","keys","some","key","beginDragNativeItem","type","dataTransfer","currentNativeSource","currentNativeHandle","registry","addSource","actions","beginDrag","setCurrentDragSourceNode","currentDragSourceNode","MOUSE_MOVE_TIMEOUT","mouseMoveTimeoutTimer","setTimeout","endDragIfSourceWasRemovedFromDOM","clearTimeout","defaultPrevented","unshift","_e","manager","globalContext","Map","lastClientOffset","hoverRafId","getSourceClientOffset","source","endDragNativeItem","endDrag","removeSource","isNodeInDocument","Boolean","body","contains","isDragging","clientOffset","publishSource","nativeType","setDragImage","sourceNode","dragPreview","offsetX","offsetY","anchorPoint","offsetPoint","dragPreviewOffset","x","y","setData","err","publishDragSource","types","hasAttribute","preventDefault","loadDataTransfer","isFirstEnter","enterLeaveCounter","enter","altKey","hover","canDrop","canDropOnTarget","requestAnimationFrame","isLastLeave","leave","reset","drop","dragDrop","tagName","isContentEditable","getActions","getMonitor","getRegistry"],"mappings":"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"}